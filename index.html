<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>利克健身集团</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #e74c3c;
            --accent-color: #3498db;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --text-color: #333;
            --light-gray: #f5f5f5;
            --border-color: #ddd;
        }
        
        body {
            background-color: var(--light-color);
            color: var(--text-color);
            transition: background-image 0.5s;
            min-height: 100vh;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        /* 头部样式 */
        header {
            background-color: rgba(44, 62, 80, 0.95);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-img {
            width: 70px;
            height: 70px;
            border-radius: 8px;
            object-fit: cover;
            border: 2px solid var(--accent-color);
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .logo-img:hover {
            transform: scale(1.05);
        }
        
        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 1px;
        }
        
        .logo-text p {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        /* 导航标签样式 */
        .tabs {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 12px 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tab:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .tab.active {
            background-color: var(--light-color);
            color: var(--primary-color);
        }
        
        /* 主要内容区域 */
        .main-content {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .tab-content {
            display: none;
            background-color: rgba(255, 255, 255, 0.92);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            min-height: 60vh;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .tab-title {
            font-size: 2rem;
            margin-bottom: 25px;
            color: var(--primary-color);
            border-bottom: 3px solid var(--secondary-color);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .tab-title i {
            color: var(--secondary-color);
        }
        
        /* 图片/视频显示区域 */
        .image-grid, .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .media-item {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .media-item:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.1);
        }
        
        .media-img, .media-video {
            width: 100%;
            height: 220px;
            object-fit: cover;
            cursor: pointer;
            display: block;
        }
        
        .media-video {
            height: 200px;
        }
        
        .media-info {
            padding: 15px;
        }
        
        .media-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: var(--primary-color);
        }
        
        .media-date {
            font-size: 0.85rem;
            color: #777;
        }
        
        /* 操作按钮区域 */
        .actions {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: #95a5a6;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #7f8c8d;
        }
        
        .btn-danger {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        /* 弹窗样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            width: 90%;
            max-width: 600px;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            max-height: 85vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .modal-title {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: #777;
            line-height: 1;
        }
        
        .close-modal:hover {
            color: var(--secondary-color);
        }
        
        /* 表单样式 */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-input, .form-textarea, .form-file {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .password-input {
            position: relative;
        }
        
        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #777;
            cursor: pointer;
        }
        
        .file-info {
            font-size: 0.85rem;
            color: #777;
            margin-top: 5px;
        }
        
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 25px;
        }
        
        /* 图片放大查看 */
        .image-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .image-viewer.active {
            display: flex;
        }
        
        .image-viewer img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }
        
        .close-viewer {
            position: absolute;
            top: 20px;
            right: 30px;
            background: none;
            border: none;
            color: white;
            font-size: 2.5rem;
            cursor: pointer;
        }
        
        /* 设置页面样式 */
        .settings-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .setting-section {
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .setting-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .current-media {
            margin-top: 20px;
            text-align: center;
        }
        
        .current-media img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            margin-top: 10px;
            cursor: pointer;
        }
        
        /* 空状态提示 */
        .empty-message {
            text-align: center;
            padding: 40px 20px;
            color: #777;
            font-size: 1.1rem;
        }
        
        .empty-message i {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #ddd;
        }
        
        /* 响应式调整 */
        @media (max-width: 992px) {
            .tabs {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .settings-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 20px;
            }
            
            .logo-container {
                flex-direction: column;
                text-align: center;
            }
            
            .tab-content {
                padding: 20px 15px;
            }
            
            .image-grid, .video-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* 管理按钮 */
        .manage-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .manage-btn {
            padding: 6px 12px;
            font-size: 0.8rem;
        }
        
        /* 密码验证提示 */
        .password-prompt {
            text-align: center;
            font-style: italic;
            color: #777;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <!-- 头部和导航 -->
    <header>
        <div class="logo-container">
            <img src="" alt="利克健身集团LOGO" class="logo-img" id="site-logo">
            <div class="logo-text">
                <h1>利克健身集团</h1>
                <p>LIKER FITNESS GROUP</p>
            </div>
        </div>
        
        <nav class="tabs">
            <button class="tab active" data-tab="announcement">
                <i class="fas fa-bullhorn"></i> 公告
            </button>
            <button class="tab" data-tab="brand">
                <i class="fas fa-building"></i> 品牌介绍
            </button>
            <button class="tab" data-tab="stores">
                <i class="fas fa-store"></i> 门店清单
            </button>
            <button class="tab" data-tab="coaches">
                <i class="fas fa-dumbbell"></i> 教练介绍
            </button>
            <button class="tab" data-tab="media">
                <i class="fas fa-photo-video"></i> 图片和视频
            </button>
            <button class="tab" data-tab="settings">
                <i class="fas fa-cog"></i> 设置
            </button>
            <button class="tab" data-tab="contact">
                <i class="fas fa-envelope"></i> 戳戳我
            </button>
        </nav>
    </header>
    
    <!-- 主要内容区域 -->
    <main class="main-content">
        <!-- 公告标签页 -->
        <section class="tab-content active" id="announcement">
            <h2 class="tab-title"><i class="fas fa-bullhorn"></i> 集团公告</h2>
            <div class="image-grid" id="announcement-grid">
                <!-- 公告图片将通过JS动态添加 -->
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" id="add-announcement">
                    <i class="fas fa-plus-circle"></i> 添加公告
                </button>
            </div>
        </section>
        
        <!-- 品牌介绍标签页 -->
        <section class="tab-content" id="brand">
            <h2 class="tab-title"><i class="fas fa-building"></i> 品牌介绍</h2>
            <div class="image-grid" id="brand-grid">
                <!-- 品牌介绍图片将通过JS动态添加 -->
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" id="add-brand">
                    <i class="fas fa-plus-circle"></i> 添加品牌介绍
                </button>
            </div>
        </section>
        
        <!-- 门店清单标签页 -->
        <section class="tab-content" id="stores">
            <h2 class="tab-title"><i class="fas fa-store"></i> 门店清单</h2>
            <div class="image-grid" id="stores-grid">
                <!-- 门店图片将通过JS动态添加 -->
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" id="add-store">
                    <i class="fas fa-plus-circle"></i> 添加门店
                </button>
            </div>
        </section>
        
        <!-- 教练介绍标签页 -->
        <section class="tab-content" id="coaches">
            <h2 class="tab-title"><i class="fas fa-dumbbell"></i> 教练介绍</h2>
            <div class="image-grid" id="coaches-grid">
                <!-- 教练图片将通过JS动态添加 -->
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" id="add-coach">
                    <i class="fas fa-plus-circle"></i> 添加教练
                </button>
            </div>
        </section>
        
        <!-- 图片和视频标签页 -->
        <section class="tab-content" id="media">
            <h2 class="tab-title"><i class="fas fa-photo-video"></i> 图片和视频</h2>
            
            <h3 style="margin: 25px 0 15px; color: var(--primary-color);">
                <i class="fas fa-images"></i> 图片库
            </h3>
            <div class="image-grid" id="images-grid">
                <!-- 图片将通过JS动态添加 -->
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" id="add-image">
                    <i class="fas fa-plus-circle"></i> 添加图片
                </button>
            </div>
            
            <h3 style="margin: 40px 0 15px; color: var(--primary-color);">
                <i class="fas fa-video"></i> 视频库
            </h3>
            <div class="video-grid" id="videos-grid">
                <!-- 视频将通过JS动态添加 -->
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" id="add-video">
                    <i class="fas fa-plus-circle"></i> 添加视频
                </button>
            </div>
        </section>
        
        <!-- 设置标签页 -->
        <section class="tab-content" id="settings">
            <h2 class="tab-title"><i class="fas fa-cog"></i> 系统设置</h2>
            
            <div class="settings-container">
                <div class="setting-section">
                    <h3 class="setting-title"><i class="fas fa-image"></i> LOGO设置</h3>
                    <p>支持格式：JPG、JPEG、PNG</p>
                    <p>建议尺寸：75cm × 75cm</p>
                    
                    <div class="current-media">
                        <p><strong>当前LOGO：</strong></p>
                        <img src="" alt="当前LOGO" id="current-logo">
                        <p class="empty-message" id="no-logo-msg">暂无LOGO</p>
                    </div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" id="upload-logo">
                            <i class="fas fa-upload"></i> 上传LOGO
                        </button>
                        <button class="btn btn-secondary" id="change-logo" disabled>
                            <i class="fas fa-edit"></i> 修改LOGO
                        </button>
                        <button class="btn btn-danger" id="delete-logo" disabled>
                            <i class="fas fa-trash"></i> 删除LOGO
                        </button>
                    </div>
                </div>
                
                <div class="setting-section">
                    <h3 class="setting-title"><i class="fas fa-paint-roller"></i> 背景设置</h3>
                    <p>支持格式：JPG、JPEG、PNG</p>
                    <p>背景将覆盖整个网页</p>
                    
                    <div class="current-media">
                        <p><strong>当前背景：</strong></p>
                        <img src="" alt="当前背景" id="current-background">
                        <p class="empty-message" id="no-bg-msg">暂无背景</p>
                    </div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" id="upload-background">
                            <i class="fas fa-upload"></i> 上传背景
                        </button>
                        <button class="btn btn-secondary" id="change-background" disabled>
                            <i class="fas fa-edit"></i> 修改背景
                        </button>
                        <button class="btn btn-danger" id="delete-background" disabled>
                            <i class="fas fa-trash"></i> 删除背景
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 戳戳我标签页 -->
        <section class="tab-content" id="contact">
            <h2 class="tab-title"><i class="fas fa-envelope"></i> 戳戳我</h2>
            <div class="image-grid" id="contact-grid">
                <!-- 戳戳我图片将通过JS动态添加 -->
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" id="add-contact">
                    <i class="fas fa-plus-circle"></i> 添加
                </button>
            </div>
        </section>
    </main>
    
    <!-- 图片放大查看器 -->
    <div class="image-viewer" id="image-viewer">
        <button class="close-viewer">&times;</button>
        <img src="" alt="放大查看的图片" id="viewer-img">
    </div>
    
    <!-- 通用弹窗 -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">弹窗标题</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="modal-form">
                    <!-- 表单内容将通过JS动态生成 -->
                </form>
            </div>
        </div>
    </div>
    
    <!-- 密码验证弹窗 -->
    <div class="modal" id="password-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">请输入管理密码</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="password-form">
                    <div class="form-group password-input">
                        <label for="password-input" class="form-label">管理密码</label>
                        <input type="password" id="password-input" class="form-input" required>
                        <button type="button" class="toggle-password" id="toggle-password">
                            <i class="fas fa-eye"></i>
                        </button>
                        <p class="password-prompt">请输入密码以继续操作</p>
                    </div>
                    <div class="modal-actions">
                        <button type="submit" class="btn btn-primary">确认</button>
                        <button type="button" class="btn btn-secondary" id="cancel-password">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        const PASSWORD = "740302"; // 管理密码
        let currentTab = "announcement"; // 当前激活的标签页
        let currentAction = ""; // 当前操作类型
        let currentDataType = ""; // 当前操作的数据类型
        let editingIndex = -1; // 当前编辑的数据索引
        let isAuthenticated = false; // 是否已通过密码验证
        
        // 数据存储结构
        let appData = {
            announcement: [], // 公告数据
            brand: [], // 品牌介绍数据
            stores: [], // 门店数据
            coaches: [], // 教练数据
            images: [], // 图片数据
            videos: [], // 视频数据
            contact: [], // 戳戳我数据
            logo: "", // 网站LOGO
            background: "" // 网站背景
        };
        
        // DOM元素
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const modal = document.getElementById('modal');
        const passwordModal = document.getElementById('password-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalForm = document.getElementById('modal-form');
        const passwordForm = document.getElementById('password-form');
        const passwordInput = document.getElementById('password-input');
        const togglePasswordBtn = document.getElementById('toggle-password');
        const closeModalBtns = document.querySelectorAll('.close-modal');
        const cancelPasswordBtn = document.getElementById('cancel-password');
        const imageViewer = document.getElementById('image-viewer');
        const viewerImg = document.getElementById('viewer-img');
        const closeViewerBtn = document.querySelector('.close-viewer');
        const siteLogo = document.getElementById('site-logo');
        const currentLogo = document.getElementById('current-logo');
        const currentBackground = document.getElementById('current-background');
        const noLogoMsg = document.getElementById('no-logo-msg');
        const noBgMsg = document.getElementById('no-bg-msg');
        
        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 从localStorage加载数据
            loadData();
            
            // 设置标签页切换事件
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                    
                    // 保存当前标签到localStorage
                    localStorage.setItem('currentTab', tabId);
                });
            });
            
            // 设置添加按钮事件
            document.getElementById('add-announcement').addEventListener('click', () => openAddModal('announcement'));
            document.getElementById('add-brand').addEventListener('click', () => openAddModal('brand'));
            document.getElementById('add-store').addEventListener('click', () => openAddModal('stores'));
            document.getElementById('add-coach').addEventListener('click', () => openAddModal('coaches'));
            document.getElementById('add-image').addEventListener('click', () => openAddModal('images'));
            document.getElementById('add-video').addEventListener('click', () => openAddModal('videos'));
            document.getElementById('add-contact').addEventListener('click', () => openAddModal('contact'));
            
            // 设置页面按钮事件
            document.getElementById('upload-logo').addEventListener('click', () => openSettingsModal('logo', 'upload'));
            document.getElementById('change-logo').addEventListener('click', () => openSettingsModal('logo', 'change'));
            document.getElementById('delete-logo').addEventListener('click', () => deleteSettingsItem('logo'));
            document.getElementById('upload-background').addEventListener('click', () => openSettingsModal('background', 'upload'));
            document.getElementById('change-background').addEventListener('click', () => openSettingsModal('background', 'change'));
            document.getElementById('delete-background').addEventListener('click', () => deleteSettingsItem('background'));
            
            // 关闭弹窗事件
            closeModalBtns.forEach(btn => {
                btn.addEventListener('click', closeModal);
            });
            
            // 关闭图片查看器事件
            closeViewerBtn.addEventListener('click', closeImageViewer);
            
            // 密码表单提交事件
            passwordForm.addEventListener('submit', function(e) {
                e.preventDefault();
                checkPassword();
            });
            
            // 取消密码验证
            cancelPasswordBtn.addEventListener('click', function() {
                closeModal();
                isAuthenticated = false;
            });
            
            // 切换密码可见性
            togglePasswordBtn.addEventListener('click', function() {
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type');
                this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
            });
            
            // 点击背景关闭弹窗
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeModal();
                }
            });
            
            passwordModal.addEventListener('click', function(e) {
                if (e.target === passwordModal) {
                    closeModal();
                }
            });
            
            imageViewer.addEventListener('click', function(e) {
                if (e.target === imageViewer) {
                    closeImageViewer();
                }
            });
            
            // 恢复上次查看的标签页
            const savedTab = localStorage.getItem('currentTab');
            if (savedTab) {
                switchTab(savedTab);
            }
            
            // 初始化显示
            renderAllData();
        });
        
        // 切换标签页
        function switchTab(tabId) {
            // 更新当前标签
            currentTab = tabId;
            
            // 更新标签按钮状态
            tabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            // 更新内容区域状态
            tabContents.forEach(content => {
                if (content.id === tabId) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }
        
        // 打开添加/编辑模态框
        function openAddModal(dataType, index = -1) {
            // 重置认证状态
            isAuthenticated = false;
            
            // 设置当前操作类型和数据
            currentDataType = dataType;
            editingIndex = index;
            
            // 根据数据类型设置弹窗标题
            const typeNames = {
                announcement: '公告',
                brand: '品牌介绍',
                stores: '门店清单',
                coaches: '教练介绍',
                images: '图片',
                videos: '视频',
                contact: '戳戳我'
            };
            
            if (index === -1) {
                currentAction = 'add';
                modalTitle.textContent = `添加${typeNames[dataType]}`;
            } else {
                currentAction = 'edit';
                modalTitle.textContent = `修改${typeNames[dataType]}`;
            }
            
            // 生成表单HTML
            let formHTML = '';
            
            if (dataType === 'videos') {
                formHTML = `
                    <div class="form-group">
                        <label for="title" class="form-label">标题</label>
                        <input type="text" id="title" class="form-input" placeholder="请输入视频标题" required>
                    </div>
                    <div class="form-group">
                        <label for="file" class="form-label">选择视频文件</label>
                        <input type="file" id="file" class="form-file" accept=".mp4,.mov" required>
                        <p class="file-info">支持格式：MP4, MOV，单个视频上限为200MB</p>
                    </div>
                `;
            } else {
                formHTML = `
                    <div class="form-group">
                        <label for="title" class="form-label">标题</label>
                        <input type="text" id="title" class="form-input" placeholder="请输入标题" required>
                    </div>
                    <div class="form-group">
                        <label for="file" class="form-label">选择图片文件</label>
                        <input type="file" id="file" class="form-file" accept=".jpg,.jpeg,.png" ${dataType === 'images' ? '' : 'multiple'} required>
                        <p class="file-info">支持格式：JPG, JPEG, PNG${dataType === 'images' ? '，不限制数量' : '，上限为5张图片'}</p>
                    </div>
                `;
            }
            
            // 如果是编辑模式，填充现有数据
            if (index !== -1) {
                setTimeout(() => {
                    const item = appData[dataType][index];
                    document.getElementById('title').value = item.title || '';
                }, 100);
            }
            
            modalForm.innerHTML = formHTML + `
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">保存</button>
                    <button type="button" class="btn btn-secondary" id="cancel-form">取消</button>
                </div>
            `;
            
            // 添加表单提交事件
            modalForm.onsubmit = function(e) {
                e.preventDefault();
                saveData();
            };
            
            // 取消按钮事件
            document.getElementById('cancel-form').addEventListener('click', closeModal);
            
            // 显示密码验证弹窗
            passwordModal.classList.add('active');
        }
        
        // 打开设置模态框
        function openSettingsModal(settingType, action) {
            // 重置认证状态
            isAuthenticated = false;
            
            // 设置当前操作类型和数据
            currentDataType = settingType;
            currentAction = action;
            
            // 根据设置类型设置弹窗标题
            const typeNames = {
                logo: 'LOGO',
                background: '背景'
            };
            
            modalTitle.textContent = `${action === 'upload' ? '上传' : '修改'}${typeNames[settingType]}`;
            
            // 生成表单HTML
            modalForm.innerHTML = `
                <div class="form-group">
                    <label for="file" class="form-label">选择${typeNames[settingType]}文件</label>
                    <input type="file" id="file" class="form-file" accept=".jpg,.jpeg,.png" required>
                    <p class="file-info">支持格式：JPG, JPEG, PNG${settingType === 'logo' ? '，建议尺寸：75cm × 75cm' : ''}</p>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">保存</button>
                    <button type="button" class="btn btn-secondary" id="cancel-form">取消</button>
                </div>
            `;
            
            // 添加表单提交事件
            modalForm.onsubmit = function(e) {
                e.preventDefault();
                saveSettings();
            };
            
            // 取消按钮事件
            document.getElementById('cancel-form').addEventListener('click', closeModal);
            
            // 显示密码验证弹窗
            passwordModal.classList.add('active');
        }
        
        // 检查密码
        function checkPassword() {
            if (passwordInput.value === PASSWORD) {
                isAuthenticated = true;
                passwordInput.value = '';
                passwordModal.classList.remove('active');
                modal.classList.add('active');
            } else {
                alert('密码错误，请重新输入！');
                passwordInput.value = '';
                passwordInput.focus();
            }
        }
        
        // 关闭所有弹窗
        function closeModal() {
            modal.classList.remove('active');
            passwordModal.classList.remove('active');
            isAuthenticated = false;
            passwordInput.value = '';
        }
        
        // 保存数据
        function saveData() {
            if (!isAuthenticated) {
                alert('请先通过密码验证！');
                return;
            }
            
            const title = document.getElementById('title').value;
            const fileInput = document.getElementById('file');
            
            if (!title.trim()) {
                alert('请输入标题！');
                return;
            }
            
            if (currentDataType !== 'videos' && fileInput.files.length === 0) {
                alert('请选择文件！');
                return;
            }
            
            if (currentDataType === 'videos' && !fileInput.files[0]) {
                alert('请选择视频文件！');
                return;
            }
            
            // 检查文件数量限制
            if (currentDataType !== 'images' && currentDataType !== 'videos' && fileInput.files.length > 5) {
                alert('最多只能上传5张图片！');
                return;
            }
            
            // 检查视频文件大小
            if (currentDataType === 'videos') {
                const videoFile = fileInput.files[0];
                if (videoFile.size > 200 * 1024 * 1024) { // 200MB
                    alert('视频文件大小不能超过200MB！');
                    return;
                }
            }
            
            // 生成上传日期
            const now = new Date();
            const uploadDate = `${now.getFullYear()}年${now.getMonth() + 1}月${now.getDate()}日 ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            // 处理文件
            if (currentDataType === 'videos') {
                // 处理视频
                const videoFile = fileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const videoData = {
                        title: title,
                        date: uploadDate,
                        src: e.target.result,
                        type: 'video'
                    };
                    
                    if (currentAction === 'add') {
                        appData[currentDataType].push(videoData);
                    } else if (currentAction === 'edit') {
                        appData[currentDataType][editingIndex] = videoData;
                    }
                    
                    saveToLocalStorage();
                    renderData(currentDataType);
                    closeModal();
                };
                
                reader.readAsDataURL(videoFile);
            } else {
                // 处理图片
                const files = Array.from(fileInput.files);
                const readers = [];
                
                files.forEach(file => {
                    const reader = new FileReader();
                    readers.push(new Promise(resolve => {
                        reader.onload = function(e) {
                            resolve({
                                title: title,
                                date: uploadDate,
                                src: e.target.result,
                                type: 'image'
                            });
                        };
                        reader.readAsDataURL(file);
                    }));
                });
                
                Promise.all(readers).then(results => {
                    if (currentAction === 'add') {
                        appData[currentDataType].push(...results);
                    } else if (currentAction === 'edit') {
                        // 编辑时只保留第一个图片
                        appData[currentDataType][editingIndex] = results[0];
                    }
                    
                    saveToLocalStorage();
                    renderData(currentDataType);
                    closeModal();
                });
            }
        }
        
        // 保存设置
        function saveSettings() {
            if (!isAuthenticated) {
                alert('请先通过密码验证！');
                return;
            }
            
            const fileInput = document.getElementById('file');
            
            if (!fileInput.files[0]) {
                alert('请选择文件！');
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                appData[currentDataType] = e.target.result;
                saveToLocalStorage();
                
                // 更新显示
                if (currentDataType === 'logo') {
                    updateLogoDisplay();
                } else if (currentDataType === 'background') {
                    updateBackgroundDisplay();
                }
                
                closeModal();
            };
            
            reader.readAsDataURL(fileInput.files[0]);
        }
        
        // 删除设置项
        function deleteSettingsItem(settingType) {
            if (!confirm(`确定要删除当前${settingType === 'logo' ? 'LOGO' : '背景'}吗？`)) {
                return;
            }
            
            // 重置认证状态
            isAuthenticated = false;
            
            // 显示密码验证弹窗
            currentDataType = settingType;
            passwordModal.classList.add('active');
            
            // 密码验证通过后执行删除
            const originalSubmit = passwordForm.onsubmit;
            passwordForm.onsubmit = function(e) {
                e.preventDefault();
                
                if (passwordInput.value === PASSWORD) {
                    isAuthenticated = true;
                    passwordInput.value = '';
                    passwordModal.classList.remove('active');
                    
                    appData[settingType] = "";
                    saveToLocalStorage();
                    
                    if (settingType === 'logo') {
                        updateLogoDisplay();
                    } else if (settingType === 'background') {
                        updateBackgroundDisplay();
                    }
                    
                    // 恢复原提交事件
                    passwordForm.onsubmit = originalSubmit;
                } else {
                    alert('密码错误，请重新输入！');
                    passwordInput.value = '';
                    passwordInput.focus();
                }
            };
        }
        
        // 渲染数据
        function renderData(dataType) {
            const containerId = dataType === 'images' ? 'images-grid' : 
                               dataType === 'videos' ? 'videos-grid' : 
                               dataType === 'contact' ? 'contact-grid' :
                               `${dataType}-grid`;
            
            const container = document.getElementById(containerId);
            if (!container) return;
            
            const data = appData[dataType];
            
            if (data.length === 0) {
                container.innerHTML = `
                    <div class="empty-message" style="grid-column: 1/-1;">
                        <i class="fas fa-${dataType === 'videos' ? 'video-slash' : 'images'}"></i>
                        <p>暂无${getDataTypeName(dataType)}，点击添加按钮上传</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            data.forEach((item, index) => {
                if (dataType === 'videos') {
                    html += `
                        <div class="media-item">
                            <video class="media-video" controls>
                                <source src="${item.src}" type="video/mp4">
                                您的浏览器不支持视频播放
                            </video>
                            <div class="media-info">
                                <div class="media-title">${item.title}</div>
                                <div class="media-date">${item.date}</div>
                                <div class="manage-buttons">
                                    <button class="btn btn-secondary manage-btn" onclick="editItem('${dataType}', ${index})">
                                        <i class="fas fa-edit"></i> 修改
                                    </button>
                                    <button class="btn btn-danger manage-btn" onclick="deleteItem('${dataType}', ${index})">
                                        <i class="fas fa-trash"></i> 删除
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="media-item">
                            <img src="${item.src}" alt="${item.title}" class="media-img" onclick="openImageViewer('${item.src}')">
                            <div class="media-info">
                                <div class="media-title">${item.title}</div>
                                <div class="media-date">${item.date}</div>
                                <div class="manage-buttons">
                                    <button class="btn btn-secondary manage-btn" onclick="editItem('${dataType}', ${index})">
                                        <i class="fas fa-edit"></i> 修改
                                    </button>
                                    <button class="btn btn-danger manage-btn" onclick="deleteItem('${dataType}', ${index})">
                                        <i class="fas fa-trash"></i> 删除
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }
            });
            
            container.innerHTML = html;
        }
        
        // 渲染所有数据
        function renderAllData() {
            renderData('announcement');
            renderData('brand');
            renderData('stores');
            renderData('coaches');
            renderData('images');
            renderData('videos');
            renderData('contact');
            updateLogoDisplay();
            updateBackgroundDisplay();
        }
        
        // 获取数据类型名称
        function getDataTypeName(dataType) {
            const names = {
                announcement: '公告',
                brand: '品牌介绍',
                stores: '门店清单',
                coaches: '教练介绍',
                images: '图片',
                videos: '视频',
                contact: '戳戳我'
            };
            return names[dataType] || '内容';
        }
        
        // 编辑项目
        function editItem(dataType, index) {
            openAddModal(dataType, index);
        }
        
        // 删除项目
        function deleteItem(dataType, index) {
            if (!confirm(`确定要删除这个${getDataTypeName(dataType)}吗？`)) {
                return;
            }
            
            // 重置认证状态
            isAuthenticated = false;
            
            // 显示密码验证弹窗
            currentDataType = dataType;
            editingIndex = index;
            passwordModal.classList.add('active');
            
            // 密码验证通过后执行删除
            const originalSubmit = passwordForm.onsubmit;
            passwordForm.onsubmit = function(e) {
                e.preventDefault();
                
                if (passwordInput.value === PASSWORD) {
                    isAuthenticated = true;
                    passwordInput.value = '';
                    passwordModal.classList.remove('active');
                    
                    appData[dataType].splice(index, 1);
                    saveToLocalStorage();
                    renderData(dataType);
                    
                    // 恢复原提交事件
                    passwordForm.onsubmit = originalSubmit;
                } else {
                    alert('密码错误，请重新输入！');
                    passwordInput.value = '';
                    passwordInput.focus();
                }
            };
        }
        
        // 更新LOGO显示
        function updateLogoDisplay() {
            if (appData.logo) {
                siteLogo.src = appData.logo;
                currentLogo.src = appData.logo;
                currentLogo.style.display = 'block';
                noLogoMsg.style.display = 'none';
                document.getElementById('change-logo').disabled = false;
                document.getElementById('delete-logo').disabled = false;
            } else {
                siteLogo.src = '';
                currentLogo.src = '';
                currentLogo.style.display = 'none';
                noLogoMsg.style.display = 'block';
                document.getElementById('change-logo').disabled = true;
                document.getElementById('delete-logo').disabled = true;
            }
        }
        
        // 更新背景显示
        function updateBackgroundDisplay() {
            if (appData.background) {
                document.body.style.backgroundImage = `url('${appData.background}')`;
                currentBackground.src = appData.background;
                currentBackground.style.display = 'block';
                noBgMsg.style.display = 'none';
                document.getElementById('change-background').disabled = false;
                document.getElementById('delete-background').disabled = false;
            } else {
                document.body.style.backgroundImage = '';
                currentBackground.src = '';
                currentBackground.style.display = 'none';
                noBgMsg.style.display = 'block';
                document.getElementById('change-background').disabled = true;
                document.getElementById('delete-background').disabled = true;
            }
        }
        
        // 打开图片查看器
        function openImageViewer(src) {
            viewerImg.src = src;
            imageViewer.classList.add('active');
        }
        
        // 关闭图片查看器
        function closeImageViewer() {
            imageViewer.classList.remove('active');
        }
        
        // 保存数据到localStorage
        function saveToLocalStorage() {
            localStorage.setItem('lickFitnessData', JSON.stringify(appData));
        }
        
        // 从localStorage加载数据
        function loadData() {
            const savedData = localStorage.getItem('lickFitnessData');
            if (savedData) {
                appData = JSON.parse(savedData);
            }
        }
        
        // 键盘事件监听
        document.addEventListener('keydown', function(e) {
            // 按ESC键关闭弹窗
            if (e.key === 'Escape') {
                closeModal();
                closeImageViewer();
            }
        });
    </script>
</body>
</html>
